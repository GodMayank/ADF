{
	"name": "scanned_retail_ticket_history_DF",
	"properties": {
		"type": "MappingDataFlow",
		"typeProperties": {
			"sources": [
				{
					"dataset": {
						"referenceName": "lnd_scanned_retail_ticket_history_azure_sql",
						"type": "DatasetReference"
					},
					"name": "lndScannedRetailTicketHistory"
				},
				{
					"dataset": {
						"referenceName": "stg_scanned_retail_ticket_history",
						"type": "DatasetReference"
					},
					"name": "StgScannedRetailTicketHistorySRC"
				}
			],
			"sinks": [
				{
					"dataset": {
						"referenceName": "stg_scanned_retail_ticket_history",
						"type": "DatasetReference"
					},
					"name": "StgScannedRetailTicketHistory"
				}
			],
			"transformations": [
				{
					"name": "derivedColumn1"
				},
				{
					"name": "select1"
				},
				{
					"name": "select2"
				}
			],
			"scriptLines": [
				"parameters{",
				"     EFFECTIVE_TO_DTTM_PARAMETER as string ('9999-01-01')",
				"}",
				"source(output(",
				"          ID as integer,",
				"          STT as string,",
				"          ACCOUNT_ID as integer,",
				"          DEVICE_ID as string,",
				"          TRANSCATION_ID as string,",
				"          START_GAME as timestamp,",
				"          END_GAME as timestamp,",
				"          NUMBER_OF_GAMES as integer,",
				"          TICKET_STATUS as string,",
				"          SCAN_INFO_STATUS as string,",
				"          STATUS as string,",
				"          PROMO_WINS as integer,",
				"          CHECK_COLLECT as integer,",
				"          WIN_AMOUNT as decimal(10,2),",
				"          REFUND_AMOUNT as decimal(10,2),",
				"          TICKET_COST as decimal(10,2),",
				"          VENUE as string,",
				"          BET_SELL_TIME as timestamp,",
				"          SELECTIONS as string,",
				"          JURISDICTION as string,",
				"          COST_PER_CHANCE as decimal(10,2),",
				"          PRICE_TABLE as string,",
				"          BET_TYPE as string,",
				"          MULTIPLIER_GAMES as integer,",
				"          REPLAY as string,",
				"          QUICK_PICK as string,",
				"          CHANNEL as string,",
				"          SCAN_DATE as timestamp,",
				"          LAST_MODIFIED as timestamp,",
				"          LOAD_DTTM as timestamp,",
				"          LOAD_REQUESTID as integer,",
				"          SOURCE as string",
				"     ),",
				"     allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     isolationLevel: 'READ_UNCOMMITTED',",
				"     format: 'table') ~> lndScannedRetailTicketHistory",
				"source(output(",
				"          srg_key as integer,",
				"          ID as integer,",
				"          STT as string,",
				"          ACCOUNT_ID as integer,",
				"          DEVICE_ID as string,",
				"          TRANSCATION_ID as string,",
				"          START_GAME as timestamp,",
				"          END_GAME as timestamp,",
				"          NUMBER_OF_GAMES as integer,",
				"          TICKET_STATUS as string,",
				"          SCAN_INFO_STATUS as string,",
				"          STATUS as string,",
				"          PROMO_WINS as integer,",
				"          CHECK_COLLECT as integer,",
				"          WIN_AMOUNT as decimal(10,2),",
				"          REFUND_AMOUNT as decimal(10,2),",
				"          TICKET_COST as decimal(10,2),",
				"          VENUE as string,",
				"          BET_SELL_TIME as timestamp,",
				"          SELECTIONS as string,",
				"          JURISDICTION as string,",
				"          COST_PER_CHANCE as decimal(10,2),",
				"          PRICE_TABLE as string,",
				"          BET_TYPE as string,",
				"          MULTIPLIER_GAMES as integer,",
				"          REPLAY as string,",
				"          QUICK_PICK as string,",
				"          CHANNEL as string,",
				"          SCAN_DATE as timestamp,",
				"          LAST_MODIFIED as timestamp,",
				"          EFFECTIVE_FROM_DTTM as timestamp,",
				"          EFFECTIVE_TO_DTTM as timestamp,",
				"          ACTIVE_FLAG as string,",
				"          DELETED_FLAG as string,",
				"          DELETED_FROM_SOURCE_FLAG as string,",
				"          CDC_HASHROW as string,",
				"          LOAD_DTTM as timestamp,",
				"          LAST_UPDATED_DTTM as timestamp,",
				"          LOAD_REQUESTID as integer,",
				"          LAST_UPDATED_REQUESTID as integer,",
				"          VERSION as integer,",
				"          SOURCE as string",
				"     ),",
				"     allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     isolationLevel: 'READ_UNCOMMITTED',",
				"     format: 'table') ~> StgScannedRetailTicketHistorySRC",
				"lndScannedRetailTicketHistory derive(EFFECTIVE_FROM_DTTM = currentTimestamp(),",
				"          EFFECTIVE_TO_DTTM = toDate($EFFECTIVE_TO_DTTM_PARAMETER, 'yyyy-MM-dd', 'UTC'),",
				"          ACTIVE_FLAG = 1,",
				"          DELETED_FLAG = 0,",
				"          DELETED_FROM_SOURCE_FLAG = 0,",
				"          CDC_HASHROW = \"\",",
				"          LAST_UPDATED_DTTM = currentTimestamp(),",
				"          LAST_UPDATED_REQUESTID = \"\",",
				"          VERSION = 1) ~> derivedColumn1",
				"select2 select(skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> select1",
				"StgScannedRetailTicketHistorySRC select(skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> select2",
				"derivedColumn1 sink(allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     input(",
				"          srg_key as integer,",
				"          ID as integer,",
				"          STT as string,",
				"          ACCOUNT_ID as integer,",
				"          DEVICE_ID as string,",
				"          TRANSCATION_ID as string,",
				"          START_GAME as timestamp,",
				"          END_GAME as timestamp,",
				"          NUMBER_OF_GAMES as integer,",
				"          TICKET_STATUS as string,",
				"          SCAN_INFO_STATUS as string,",
				"          STATUS as string,",
				"          PROMO_WINS as integer,",
				"          CHECK_COLLECT as integer,",
				"          WIN_AMOUNT as decimal(10,2),",
				"          REFUND_AMOUNT as decimal(10,2),",
				"          TICKET_COST as decimal(10,2),",
				"          VENUE as string,",
				"          BET_SELL_TIME as timestamp,",
				"          SELECTIONS as string,",
				"          JURISDICTION as string,",
				"          COST_PER_CHANCE as decimal(10,2),",
				"          PRICE_TABLE as string,",
				"          BET_TYPE as string,",
				"          MULTIPLIER_GAMES as integer,",
				"          REPLAY as string,",
				"          QUICK_PICK as string,",
				"          CHANNEL as string,",
				"          SCAN_DATE as timestamp,",
				"          LAST_MODIFIED as timestamp,",
				"          EFFECTIVE_FROM_DTTM as timestamp,",
				"          EFFECTIVE_TO_DTTM as timestamp,",
				"          ACTIVE_FLAG as string,",
				"          DELETED_FLAG as string,",
				"          DELETED_FROM_SOURCE_FLAG as string,",
				"          CDC_HASHROW as string,",
				"          LOAD_DTTM as timestamp,",
				"          LAST_UPDATED_DTTM as timestamp,",
				"          LOAD_REQUESTID as integer,",
				"          LAST_UPDATED_REQUESTID as integer,",
				"          VERSION as integer,",
				"          SOURCE as string",
				"     ),",
				"     deletable:false,",
				"     insertable:true,",
				"     updateable:false,",
				"     upsertable:false,",
				"     format: 'table',",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true,",
				"     errorHandlingOption: 'stopOnFirstError') ~> StgScannedRetailTicketHistory"
			]
		}
	}
}